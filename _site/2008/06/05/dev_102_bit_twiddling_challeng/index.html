
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>Dev 102 bit twiddling challenge</title>
    
    <meta name="author" content="Hugh Brown">

    <!-- Enable responsive viewport -->
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!-- Le HTML5 shim, for IE6-8 support of HTML elements -->
    <!--[if lt IE 9]>
      <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Le styles -->
    <link href="/assets/themes/twitter/bootstrap/css/bootstrap.2.2.2.min.css" rel="stylesheet">
    <link href="/assets/themes/twitter/css/style.css?body=1" rel="stylesheet" type="text/css" media="all">

    <!-- Le fav and touch icons -->
  <!-- Update these with your own images
    <link rel="shortcut icon" href="images/favicon.ico">
    <link rel="apple-touch-icon" href="images/apple-touch-icon.png">
    <link rel="apple-touch-icon" sizes="72x72" href="images/apple-touch-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="114x114" href="images/apple-touch-icon-114x114.png">
  -->

    <!-- atom & rss feed -->
    <link href="/atom.xml" type="application/atom+xml" rel="alternate" title="Sitewide ATOM Feed">
    <link href="/rss.xml" type="application/rss+xml" rel="alternate" title="Sitewide RSS Feed">

  </head>

  <body>
    <div class="navbar">
      <div class="navbar-inner">
        <div class="container-narrow">
          <a class="brand" href="/">Jekyll Bootstrap</a>
          <ul class="nav">
            
            
            


  
    
      
      	
      	<li><a href="/tags.html">Tags</a></li>
      	
      
    
  
    
      
    
  
    
      
      	
      	<li><a href="/archive.html">Archive</a></li>
      	
      
    
  
    
      
      	
      	<li><a href="/categories.html">Categories</a></li>
      	
      
    
  
    
      
    
  
    
      
      	
      	<li><a href="/pages.html">Pages</a></li>
      	
      
    
  
    
      
    
  
    
      
    
  



          </ul>
        </div>
      </div>
    </div>

    <div class="container-narrow">

      <div class="content">
        
<div class="page-header">
  <h1>Dev 102 bit twiddling challenge </h1>
</div>

<div class="row-fluid post-full">
  <div class="span12">
    <div class="date">
      <span>05 June 2008</span>
    </div>
    <div class="content">
      <p>Recently Dev102 had a <a href="http://www.dev102.com/2008/05/05/a-programming-job-interview-challenge-2/">bit twiddling programming challenge</a>.</p>

<blockquote class="quote"><p>Given a 1000X1000 grayscale image where each pixel is 8 bits, you need to reverse the order of the bits in each pixel. Example: 10001101 becomes 10110001, 00111101 becomes 10111100 and so on. Provide the most efficient solution in the manner of performance because another input is that you need to handle many images per second.</p></blockquote>

<p>The challenge amounts to providing code that transforms every byte in a bitmap so that its bits were reversed -- bits 1 and 8 exchange, bits 2 and 7 exchange, bits 3 and 6 exchange, and bits 4 and 5 exchange. The obvious answer is to create a lookup table because an individual byte will always map onto a particular reversed byte. You may as well do the calculation only once and then just use the byte value as a lookup into the table of reversed bytes.</p>

<p>So that part is obvious and not very interesting. How to reverse the bits though?</p>

<p>There are <a href="http://www.dev102.com/2008/05/12/a-programming-job-interview-challenge-3/">lots of good answers</a> (and I really like <a href="http://igoro.com/archive/programming-job-interview-challenge/">this one</a>) but none uses my approach. I took each pair of bits to be exchanged and observed that there can be four possible outcomes: 00, 01, 10, and 11. If they come out 00 or 11, you don't have to do anything: they are already reversed. If they are 01 or 10, then you need to map them to 10 or 01, respectively. And you can get that by XOR-ing the result with the mask that produced the two bit combination. That is:</p>
<ol>
	<li>AND the byte with an appropriate mask</li>
	<li>if the result has one bit set of the two,</li>
	<li>XOR the masked result with the mask.</li>
</ol>
<p>And the code looks like this:</p>
<pre class="prettyprint lang-py">def reflected(x) :
    result = 0
    masks = (0x81, 0x42, 0x24, 0x18)
    outcomes = ((0x80, 0x01), (0x40, 0x02), 
        (0x20, 0x04), (0x10, 0x08))
    for mask, outcome in zip(masks, outcomes) :
        y = x & mask
        if y in outcome :
            y ^= mask
        result |= y
    return result</pre>

<p>[<a href="/files/bit_twiddling.py.txt">Python source</a>]</p>

    </div>

    

    

    <hr>
    <div class="pagination">
      <ul>
      
        <li class="prev"><a href="/coins/2008/06/04/us_state_quarter_traders" title="US State Quarters for Trading">&larr; Previous</a></li>
      
        <li><a href="/archive.html">Archive</a></li>
      
        <li class="next"><a href="/programming/2008/06/05/current_design_methodologies" title="Current design methodologies">Next &rarr;</a></li>
      
      </ul>
    </div>
    <hr>
    


  <div id="disqus_thread"></div>
<script type="text/javascript">
    var disqus_developer = 1;
    var disqus_shortname = 'jekyllbootstrap'; // required: replace example with your forum shortname
    
    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">blog comments powered by <span class="logo-disqus">Disqus</span></a>




  </div>
</div>


      </div>
      <hr>
      <footer>
        <p>&copy; 2013 Hugh Brown
          with help from <a href="http://jekyllbootstrap.com" target="_blank" title="The Definitive Jekyll Blogging Framework">Jekyll Bootstrap</a>
          and <a href="http://twitter.github.com/bootstrap/" target="_blank">Twitter Bootstrap</a>
        </p>
      </footer>

    </div>

    
  </body>
</html>

